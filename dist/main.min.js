"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeCommon=void 0,require("core-js/modules/esnext.async-iterator.reduce.js"),require("core-js/modules/esnext.iterator.constructor.js"),require("core-js/modules/esnext.iterator.reduce.js");var _gulpBabel=_interopRequireDefault(require("gulp-babel")),_copyResources=require("./functions/copyResources"),_gulp=require("gulp"),_replaceImports=require("./functions/replaceImports"),_replaceImportMeta=require("./functions/replaceImportMeta"),_resolveImports=require("./functions/resolveImports"),_through=_interopRequireDefault(require("through2")),_customChanges=require("./functions/customChanges");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const makeCommon=(e,r,o={})=>(0,_gulp.src)(e).pipe(_through.default.obj((function(t,s,u){const p=void 0===o.rootPath?e:o.rootPath,c=(0,_resolveImports.resolveImports)(t,p).reduce((0,_replaceImports.replaceImports)(e,r,o),t.contents.toString());(0,_copyResources.copyResources)(e,o),t.contents=Buffer.from((0,_customChanges.customChanges)(e,c,o)),this.push(t),u()}))).pipe((0,_gulpBabel.default)()).pipe(_through.default.obj((function(e,r,o){e.contents=Buffer.from((0,_replaceImportMeta.replaceImportMeta)(e.contents.toString())),this.push(e),o()}))).pipe((0,_gulp.dest)(r));exports.makeCommon=makeCommon;