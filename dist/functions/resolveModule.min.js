"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.resolveModule=exports.default=void 0,require("core-js/modules/esnext.async-iterator.filter.js"),require("core-js/modules/esnext.async-iterator.map.js"),require("core-js/modules/esnext.iterator.constructor.js"),require("core-js/modules/esnext.iterator.filter.js"),require("core-js/modules/esnext.iterator.map.js");var _fs=require("fs"),_strAfterLast=_interopRequireDefault(require("../utilities/strAfterLast")),_makeFilepath=_interopRequireDefault(require("../utilities/makeFilepath")),_testFilesystem=require("test-filesystem"),_regexEscape=_interopRequireDefault(require("../utilities/regexEscape")),_strBeforeLast=_interopRequireDefault(require("../utilities/strBeforeLast")),_makeRelativePath=_interopRequireDefault(require("../utilities/makeRelativePath"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const modulesDirectory="node_modules",resolveModule=(e,t,r="")=>{e=(0,_makeFilepath.default)(e),r||(r=e);let s=!0;t.startsWith("#")&&(t=t.slice(1),r=(0,_makeFilepath.default)(r,"vendor"),s=!1),t.startsWith("./")&&(t=t.slice(2),s=!1),t.startsWith("../")&&(t=t.slice(3),s=!1),s&&(t=(0,_makeRelativePath.default)(e,t));let i=(0,_makeFilepath.default)(r,(0,_strBeforeLast.default)(t,"/"));if((0,_testFilesystem.fileExists)(i)){let e=t.includes("/")?(0,_strAfterLast.default)(t,"/"):t;e=(0,_makeFilepath.default)(e),e=(0,_regexEscape.default)(e),e.includes("\\$\\{")&&(e=e.replace(/(\\\$\\{.+\\})+/g,".+"));const r=new RegExp(`^${e}$`),s=(0,_fs.readdirSync)(i).filter((e=>r.test(e)));if(s.length)return s.map((e=>(0,_makeFilepath.default)(i,e))).filter(_testFilesystem.fileExists)}if("node_modules"===r)return[];"node_modules"===(0,_strAfterLast.default)(r,"/")&&(r=(0,_makeFilepath.default)(r,"../../"));const l=(0,_makeFilepath.default)(r,"node_modules");return l!==e&&l?resolveModule(e,t,l):[]};exports.resolveModule=resolveModule;var _default=exports.default=resolveModule;