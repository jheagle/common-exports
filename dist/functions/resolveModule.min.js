"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.resolveModule=void 0,require("core-js/modules/esnext.async-iterator.filter.js"),require("core-js/modules/esnext.async-iterator.map.js"),require("core-js/modules/esnext.iterator.constructor.js"),require("core-js/modules/esnext.iterator.filter.js"),require("core-js/modules/esnext.iterator.map.js");var _fs=require("fs"),_strAfterLast=require("../utilities/strAfterLast"),_makeFilepath=require("../utilities/makeFilepath"),_testFilesystem=require("test-filesystem"),_regexEscape=require("../utilities/regexEscape"),_strBeforeLast=require("../utilities/strBeforeLast"),_makeRelativePath=require("../utilities/makeRelativePath");const modulesDirectory="node_modules",resolveModule=(e,t,s="")=>{e=(0,_makeFilepath.makeFilepath)(e),s||(s=e);let r=!0;t.startsWith("#")&&(t=t.slice(1),s=(0,_makeFilepath.makeFilepath)(s,"vendor"),r=!1),t.startsWith("./")&&(t=t.slice(2),r=!1),t.startsWith("../")&&(t=t.slice(3),r=!1),r&&(t=(0,_makeRelativePath.makeRelativePath)(e,t));let i=(0,_makeFilepath.makeFilepath)(s,(0,_strBeforeLast.strBeforeLast)(t,"/"));if((0,_testFilesystem.fileExists)(i)){let e=t.includes("/")?(0,_strAfterLast.strAfterLast)(t,"/"):t;e=(0,_makeFilepath.makeFilepath)(e),e=(0,_regexEscape.regexEscape)(e),e.includes("\\$\\{")&&(e=e.replace(/(\\\$\\{.+\\})+/g,".+"));const s=new RegExp(`^${e}$`),r=(0,_fs.readdirSync)(i).filter((e=>s.test(e)));if(r.length)return r.map((e=>(0,_makeFilepath.makeFilepath)(i,e))).filter(_testFilesystem.fileExists)}if("node_modules"===s)return[];"node_modules"===(0,_strAfterLast.strAfterLast)(s,"/")&&(s=(0,_makeFilepath.makeFilepath)(s,"../../"));const a=(0,_makeFilepath.makeFilepath)(s,"node_modules");return a!==e&&a?resolveModule(e,t,a):[]};exports.resolveModule=resolveModule;