import{readFileSync}from"fs";import makeFilepath from"../utilities/makeFilepath";import{fileExists}from"test-filesystem";export const resolveMainFile=e=>{if(!fileExists(e)){const t=`${e}.js`;if(fileExists(t))return t;const i=`${e}.mjs`;return fileExists(i)?i:null}if(e.endsWith(".js")||e.endsWith(".mjs"))return e;const t=makeFilepath(`${e}.js`);if(fileExists(t))return t;const i=makeFilepath(`${e}.mjs`);if(fileExists(i))return i;const s=makeFilepath(e,"package.json");if(fileExists(s)){const t=JSON.parse(readFileSync(s).toString());if(t.exports)return"string"==typeof t.exports?makeFilepath(e,t.exports):makeFilepath(e,t.exports.default);if(t.main)return makeFilepath(e,t.main)}const r=makeFilepath(e,"index.js");if(fileExists(r))return r;const l=makeFilepath(e,"index.mjs");return fileExists(l)?l:null};export default resolveMainFile;