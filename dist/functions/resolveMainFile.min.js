"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.resolveMainFile=void 0;var _fs=require("fs"),_makeFilepath=require("../utilities/makeFilepath"),_testFilesystem=require("test-filesystem");const resolveMainFile=e=>{if(!(0,_testFilesystem.fileExists)(e)){const t=`${e}.js`;if((0,_testFilesystem.fileExists)(t))return t;const s=`${e}.mjs`;return(0,_testFilesystem.fileExists)(s)?s:null}if(e.endsWith(".js")||e.endsWith(".mjs"))return e;const t=(0,_makeFilepath.makeFilepath)(`${e}.js`);if((0,_testFilesystem.fileExists)(t))return t;const s=(0,_makeFilepath.makeFilepath)(`${e}.mjs`);if((0,_testFilesystem.fileExists)(s))return s;const i=(0,_makeFilepath.makeFilepath)(e,"package.json");if((0,_testFilesystem.fileExists)(i)){const t=JSON.parse((0,_fs.readFileSync)(i).toString());if(t.exports)return"string"==typeof t.exports?(0,_makeFilepath.makeFilepath)(e,t.exports):(0,_makeFilepath.makeFilepath)(e,t.exports.default);if(t.main)return(0,_makeFilepath.makeFilepath)(e,t.main)}const l=(0,_makeFilepath.makeFilepath)(e,"index.js");if((0,_testFilesystem.fileExists)(l))return l;const a=(0,_makeFilepath.makeFilepath)(e,"index.mjs");return(0,_testFilesystem.fileExists)(a)?a:null};exports.resolveMainFile=resolveMainFile;