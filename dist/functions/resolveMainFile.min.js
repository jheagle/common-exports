"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.resolveMainFile=exports.default=void 0;var _fs=require("fs"),_makeFilepath=_interopRequireDefault(require("../utilities/makeFilepath")),_testFilesystem=require("test-filesystem");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const resolveMainFile=e=>{if(!(0,_testFilesystem.fileExists)(e)){const t=`${e}.js`;if((0,_testFilesystem.fileExists)(t))return t;const s=`${e}.mjs`;return(0,_testFilesystem.fileExists)(s)?s:null}if(e.endsWith(".js")||e.endsWith(".mjs"))return e;const t=(0,_makeFilepath.default)(`${e}.js`);if((0,_testFilesystem.fileExists)(t))return t;const s=(0,_makeFilepath.default)(`${e}.mjs`);if((0,_testFilesystem.fileExists)(s))return s;const i=(0,_makeFilepath.default)(e,"package.json");if((0,_testFilesystem.fileExists)(i)){const t=JSON.parse((0,_fs.readFileSync)(i).toString());if(t.exports)return"string"==typeof t.exports?(0,_makeFilepath.default)(e,t.exports):(0,_makeFilepath.default)(e,t.exports.default);if(t.main)return(0,_makeFilepath.default)(e,t.main)}const l=(0,_makeFilepath.default)(e,"index.js");if((0,_testFilesystem.fileExists)(l))return l;const r=(0,_makeFilepath.default)(e,"index.mjs");return(0,_testFilesystem.fileExists)(r)?r:null};exports.resolveMainFile=resolveMainFile;var _default=exports.default=resolveMainFile;